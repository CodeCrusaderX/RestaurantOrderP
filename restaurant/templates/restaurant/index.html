{% extends 'restaurant/base.html' %}

{% block content %}
<div class="container"
    style="display: flex; flex-direction: column; height: 100vh; justify-content: center; align-items: center;">
    <h1 style="text-align: center; margin-bottom: 30px;">Select Table</h1>

    {% if error %}
    <div
        style="background: #D32F2F; color: white; padding: 10px; border-radius: 8px; margin-bottom: 20px; text-align: center;">
        {{ error }}
    </div>
    {% endif %}

    <div class="card" style="width: 100%; max-width: 400px; padding: 30px;">
        <form method="POST" action="{% url 'index' %}" style="display: flex; flex-direction: column; gap: 20px;">
            {% csrf_token %}

            <div>
                <label for="table_select"
                    style="display: block; margin-bottom: 10px; color: var(--secondary-text);">Choose a table:</label>
                <select name="table_number" id="table_select"
                    style="background: #2C2C2C; border: 1px solid #3E3E3E; color: white; padding: 12px; border-radius: 8px; width: 100%; font-size: 1rem; outline: none;">
                    {% for table in tables %}
                    {% if not table.is_occupied %}
                    <option value="{{ table.number }}">
                        Table {{ table.number }}
                    </option>
                    {% endif %}
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn btn-primary btn-block">
                Proceed
            </button>
        </form>
    </div>
</div>

<script>
    // Auto-refresh to keep table availability updated
    // Check if user is interacting before reloading to avoid disruption? 
    // For simplicity, just reload every 10s if not focusing inputs
    setInterval(() => {
        if (!document.querySelector('select:focus')) {
            window.location.reload();
        }
    }, 10000);
</script>
{% endblock %}